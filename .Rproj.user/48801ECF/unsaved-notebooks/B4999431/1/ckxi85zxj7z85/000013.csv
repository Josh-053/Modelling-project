"0","data <- read.table(""dataset.txt"", "
"0","                  sep = "" "",        # space-separated"
"0","                  na.strings = ""."", # treat ""."" as NA"
"0","                  header = TRUE)"
"0",""
"0","data <- data %>%"
"0","  mutate(DOSE = as.numeric(DOSE),"
"0","         EVID = case_when("
"0","           is.na(CONC) & DOSE!=0 ~ 1,"
"0","           CONC>=0 ~ 0,"
"0","           is.na(CONC) & is.na(DOSE) ~ 2))"
"0","         "
"0","data <- data %>% group_by(ID) %>%  "
"0","  fill(c(BW),.direction = ""downup"") %>% "
"0","  ungroup()"
"0",""
"0","data$AMT = data$DOSE * data$BW"
"0",""
"0","write.table(data, file = ""dataset_clean.txt"", quote = FALSE, sep = "" "", na = ""."")"
"0","write.csv(data, file = ""dataset_clean.csv"", quote = FALSE, na = ""."")"
