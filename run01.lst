vr 12 dec 2025 13:33:43 CET
;; 1. Based on: run01
;; 2. Description: PMX001 One Compartment
;; x1. Joshua I., Ali K.
;; 2025-12-09
$PROBLEM    PMX001 One Compartment
$INPUT      DUMMY=DROP ID TIME WEEK DOSE=DROP RATE CONC=DV ADA BW ALB
            SEX AGE CREAT COL EVID BLQ AMT
$DATA      dataset_clean.csv IGNORE=@
$SUBROUTINE ADVAN13 ; general nonlinear model
            TOL=9 ; tolerance for $DES,higher TOL: more accurate,but slower computation

; TOL=9 -> DES will aim for accuracy of 1E-9 for each integration step
$MODEL      NCOMP=1 ; number of compartments
            COMP=(DOSE,DEFDOSE,DEFOBS) ; first (central) compartment
$PK
TVCL = THETA(1)
  CL = TVCL * EXP(ETA(1))
 TVV = THETA(2)
   V = TVV  * EXP(ETA(2))
 K10 = CL/V
  S1 = V ; scale prediction based on DOSE (mmol) and DV (mmol/L)

$DES DADT(1) = -K10*A(1)  ; ODE for central compartment

$ERROR
IPRED = F
LLOQ = 1

PROP = IPRED*THETA(3)
ADD = THETA(4)
IF (BLQ.EQ.1) ADD = ADD + LLOQ

W = SQRT(ADD**2+PROP**2)

IF (W.LE.0.000001) W=0.000001 ; Protective code

IRES=CONC-IPRED
IWRES=IRES/W

Y = IPRED + W*ERR(1)

$THETA  (0,0.012) ; CL [1]
 (0,4.45) ; V [2,3]
 (0,0.2,0.5) ; PROP error ()
 (0,0.2,10) ; ADD (mg/L)
$OMEGA  0.05  ; IIV/BSV CL, fix to 0 to exclude
 0.05  ;  IIV/BSV V
$SIGMA  1  FIX  ; errors already adjusted under $ERROR as THETAs
 ; residual variability
$ESTIMATION METHOD=1 INTERACTION ; FOCE-I
            MAXEVAL=9999 SIG=3 PRINT=5
$COVARIANCE PRINT=E UNCONDITIONAL MATRIX=S
 ; output table for standard outcomes
$TABLE      ID TIME DV EVID PRED IPRED WRES IWRES RES IRES CWRES
            NOPRINT ONEHEADER FILE=run01_sdtab
 ; output table for PK parameters
$TABLE      ID CL V K10 NOPRINT NOAPPEND ONEHEADER FILE=run01_patab
 ; output table for categorical covariates
$TABLE      ID ADA SEX COL NOPRINT NOAPPEND ONEHEADER FILE=run01_catab
 ; output table for continuous covariates
$TABLE      ID BW ALB AGE CREAT NOPRINT NOAPPEND ONEHEADER
            FILE=run01_cotab
;; REFERENCES

;; 1] https://www.ncbi.nlm.nih.gov/books/NBK557889/

;; 2] https://pmc.ncbi.nlm.nih.gov/articles/PMC8301575/

;; 3] https://ascpt.onlinelibrary.wiley.com/doi/abs/10.1016/j.clpt.2004.12.212


NM-TRAN MESSAGES
  
 WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1
             
 (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.
  
Note: Analytical 2nd Derivatives are constructed in FSUBS but are never used.
      You may insert $ABBR DERIV2=NO after the first $PROB to save FSUBS construction and compilation time
  

License Registered to: Erwin DREESEN KU Leuven
Expiration Date:    25 JAN 2026
Current Date:       12 DEC 2025
Days until program expires :  48
1NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) VERSION 7.6.0 (nm760)
 ORIGINALLY DEVELOPED BY STUART BEAL, LEWIS SHEINER, AND ALISON BOECKMANN
 CURRENT DEVELOPERS ARE ROBERT BAUER, ICON DEVELOPMENT SOLUTIONS,
 AND ALISON BOECKMANN. IMPLEMENTATION, EFFICIENCY, AND STANDARDIZATION
 PERFORMED BY NOUS INFOSYSTEMS.

 PROBLEM NO.:         1
 PMX001 One Compartment
0DATA CHECKOUT RUN:              NO
 DATA SET LOCATED ON UNIT NO.:    2
 THIS UNIT TO BE REWOUND:        NO
 CREATE/ADD TO FDATA.csv:        YES
 NO. OF DATA RECS IN DATA SET:    11475
 NO. OF DATA ITEMS IN DATA SET:  16
 ID DATA ITEM IS DATA ITEM NO.:   1
 DEP VARIABLE IS DATA ITEM NO.:   5
 MDV DATA ITEM IS DATA ITEM NO.: 16
0INDICES PASSED TO SUBROUTINE PRED:
  13   2  15   4   0   0   0   0   0   0   0
0LABELS FOR DATA ITEMS:
 ID TIME WEEK RATE CONC ADA BW ALB SEX AGE CREAT COL EVID BLQ AMT MDV
0(NONBLANK) LABELS FOR PRED-DEFINED ITEMS:
 CL V K10 IPRED IRES IWRES
0FORMAT FOR DATA:
 (4(3E21.0/),3E21.0,1F2.0)

 TOT. NO. OF OBS RECS:     2801
 TOT. NO. OF INDIVIDUALS:       75
0LENGTH OF THETA:   4
0DEFAULT THETA BOUNDARY TEST OMITTED:    NO
0OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:   2
0DEFAULT OMEGA BOUNDARY TEST OMITTED:    NO
0SIGMA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:   1
0DEFAULT SIGMA BOUNDARY TEST OMITTED:    NO
0INITIAL ESTIMATE OF THETA:
 LOWER BOUND    INITIAL EST    UPPER BOUND
  0.0000E+00     0.1200E-01     0.1000E+07
  0.0000E+00     0.4450E+01     0.1000E+07
  0.0000E+00     0.2000E+00     0.5000E+00
  0.0000E+00     0.2000E+00     0.1000E+02
0INITIAL ESTIMATE OF OMEGA:
 0.5000E-01
 0.0000E+00   0.5000E-01
0INITIAL ESTIMATE OF SIGMA:
 0.1000E+01
0SIGMA CONSTRAINED TO BE THIS INITIAL ESTIMATE
0COVARIANCE STEP OMITTED:        NO
 R MATRIX SUBSTITUTED:           NO
 S MATRIX SUBSTITUTED:          YES
 EIGENVLS. PRINTED:             YES
 SPECIAL COMPUTATION:            NO
 COMPRESSED FORMAT:              NO
 GRADIENT METHOD USED:     NOSLOW
 SIGDIGITS ETAHAT (SIGLO):                  -1
 SIGDIGITS GRADIENTS (SIGL):                -1
 EXCLUDE COV FOR FOCE (NOFCOV):              NO
 Cholesky Transposition of R Matrix (CHOLROFF):0
 KNUTHSUMOFF:                                -1
 RESUME COV ANALYSIS (RESUME):               NO
 SIR SAMPLE SIZE (SIRSAMPLE):
 NON-LINEARLY TRANSFORM THETAS DURING COV (THBND): 1
 PRECONDTIONING CYCLES (PRECOND):        0
 PRECONDTIONING TYPES (PRECONDS):        TOS
 FORCED PRECONDTIONING CYCLES (PFCOND):0
 PRECONDTIONING TYPE (PRETYPE):        0
 FORCED POS. DEFINITE SETTING DURING PRECONDITIONING: (FPOSDEF):0
 SIMPLE POS. DEFINITE SETTING: (POSDEF):-1
0TABLES STEP OMITTED:    NO
 NO. OF TABLES:           4
 SEED NUMBER (SEED):    11456
 NPDTYPE:    0
 INTERPTYPE:    0
 RANMETHOD:             3U
 MC SAMPLES (ESAMPLE):    300
 WRES SQUARE ROOT TYPE (WRESCHOL): EIGENVALUE
0-- TABLE   1 --
0RECORDS ONLY:    ALL
04 COLUMNS APPENDED:    YES
 PRINTED:                NO
 HEADERS:               ONE
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 IDFORMAT:
 LFORMAT:
 RFORMAT:
 FIXED_EFFECT_ETAS:
0USER-CHOSEN ITEMS:
 ID TIME CONC EVID IPRED IWRES IRES CWRES
0-- TABLE   2 --
0RECORDS ONLY:    ALL
04 COLUMNS APPENDED:    NO
 PRINTED:                NO
 HEADERS:               ONE
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 IDFORMAT:
 LFORMAT:
 RFORMAT:
 FIXED_EFFECT_ETAS:
0USER-CHOSEN ITEMS:
 ID CL V K10
0-- TABLE   3 --
0RECORDS ONLY:    ALL
04 COLUMNS APPENDED:    NO
 PRINTED:                NO
 HEADERS:               ONE
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 IDFORMAT:
 LFORMAT:
 RFORMAT:
 FIXED_EFFECT_ETAS:
0USER-CHOSEN ITEMS:
 ID ADA SEX COL
0-- TABLE   4 --
0RECORDS ONLY:    ALL
04 COLUMNS APPENDED:    NO
 PRINTED:                NO
 HEADERS:               ONE
 FILE TO BE FORWARDED:   NO
 FORMAT:                S1PE11.4
 IDFORMAT:
 LFORMAT:
 RFORMAT:
 FIXED_EFFECT_ETAS:
0USER-CHOSEN ITEMS:
 ID BW ALB AGE CREAT
1DOUBLE PRECISION PREDPP VERSION 7.6.0 (nm760)

 GENERAL NONLINEAR KINETICS MODEL WITH STIFF/NONSTIFF EQUATIONS (LSODA, ADVAN13)
0MODEL SUBROUTINE USER-SUPPLIED - ID NO. 9999
0MAXIMUM NO. OF BASIC PK PARAMETERS:   1
0COMPARTMENT ATTRIBUTES
 COMPT. NO.   FUNCTION   INITIAL    ON/OFF      DOSE      DEFAULT    DEFAULT
                         STATUS     ALLOWED    ALLOWED    FOR DOSE   FOR OBS.
    1         DOSE         ON         YES        YES        YES        YES
    2         OUTPUT       OFF        YES        NO         NO         NO
 INITIAL (BASE) TOLERANCE SETTINGS:
 NRD (RELATIVE) VALUE(S) OF TOLERANCE:   9
 ANRD (ABSOLUTE) VALUE(S) OF TOLERANCE:  12
1
 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG
 COMPT. NO.                             INDICES
              SCALE      BIOAVAIL.   ZERO-ORDER  ZERO-ORDER  ABSORB
                         FRACTION    RATE        DURATION    LAG
    1            2           *           *           *           *
    2            *           -           -           -           -
             - PARAMETER IS NOT ALLOWED FOR THIS MODEL
             * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;
               WILL DEFAULT TO ONE IF APPLICABLE
0DATA ITEM INDICES USED BY PRED ARE:
   EVENT ID DATA ITEM IS DATA ITEM NO.:     13
   TIME DATA ITEM IS DATA ITEM NO.:          2
   DOSE AMOUNT DATA ITEM IS DATA ITEM NO.:  15
   DOSE RATE DATA ITEM IS DATA ITEM NO.:     4

0PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.
 PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES.
0ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.
0DES SUBROUTINE USES COMPACT STORAGE MODE.
1


 #TBLN:      1
 #METH: First Order Conditional Estimation with Interaction

 ESTIMATION STEP OMITTED:                 NO
 SHRINK INFO WITH EVALUATION (EVALSHRINK) NO
 ANALYSIS TYPE:                           POPULATION
 NUMBER OF SADDLE POINT RESET ITERATIONS:      0
 GRADIENT METHOD USED:               NOSLOW
 CONDITIONAL ESTIMATES USED:              YES
 CENTERED ETA:                            NO
 EPS-ETA INTERACTION:                     YES
 LAPLACIAN OBJ. FUNC.:                    NO
 NO. OF FUNCT. EVALS. ALLOWED:            9999
 NO. OF SIG. FIGURES REQUIRED:            3
 INTERMEDIATE PRINTOUT:                   YES
 ESTIMATE OUTPUT TO MSF:                  NO
 IND. OBJ. FUNC. VALUES SORTED:           NO
 NUMERICAL DERIVATIVE
       FILE REQUEST (NUMDER):               NONE
 MAP (ETAHAT) ESTIMATION METHOD (OPTMAP):   0
 ETA HESSIAN EVALUATION METHOD (ETADER):    0
 INITIAL ETA FOR MAP ESTIMATION (MCETA):    0
 SIGDIGITS FOR MAP ESTIMATION (SIGLO):      100
 GRADIENT SIGDIGITS OF
       FIXED EFFECTS PARAMETERS (SIGL):     100
 NOPRIOR SETTING (NOPRIOR):                 0
 NOCOV SETTING (NOCOV):                     OFF
 DERCONT SETTING (DERCONT):                 OFF
 FINAL ETA RE-EVALUATION (FNLETA):          1
 EXCLUDE NON-INFLUENTIAL (NON-INFL.) ETAS
       IN SHRINKAGE (ETASTYPE):             NO
 NON-INFL. ETA CORRECTION (NONINFETA):      0
 RAW OUTPUT FILE (FILE): psn.ext
 EXCLUDE TITLE (NOTITLE):                   NO
 EXCLUDE COLUMN LABELS (NOLABEL):           NO
 FORMAT FOR ADDITIONAL FILES (FORMAT):      S1PE12.5
 PARAMETER ORDER FOR OUTPUTS (ORDER):       TSOL
 KNUTHSUMOFF:                               0
 INCLUDE LNTWOPI:                           NO
 INCLUDE CONSTANT TERM TO PRIOR (PRIORC):   NO
 INCLUDE CONSTANT TERM TO OMEGA (ETA) (OLNTWOPI):NO
 ADDITIONAL CONVERGENCE TEST (CTYPE=4)?:    NO
 EM OR BAYESIAN METHOD USED:                 NONE

 TOLERANCES FOR ESTIMATION/EVALUATION STEP:
 NRD (RELATIVE) VALUE(S) OF TOLERANCE:   9
 ANRD (ABSOLUTE) VALUE(S) OF TOLERANCE:  12
 TOLERANCES FOR COVARIANCE STEP:
 NRD (RELATIVE) VALUE(S) OF TOLERANCE:   9
 ANRD (ABSOLUTE) VALUE(S) OF TOLERANCE:  12
 TOLERANCES FOR TABLE/SCATTER STEP:
 NRD (RELATIVE) VALUE(S) OF TOLERANCE:   9
 ANRD (ABSOLUTE) VALUE(S) OF TOLERANCE:  12

 THE FOLLOWING LABELS ARE EQUIVALENT
 PRED=PREDI
 RES=RESI
 WRES=WRESI
 IWRS=IWRESI
 IPRD=IPREDI
 IRS=IRESI

 MONITORING OF SEARCH:


0ITERATION NO.:    0    OBJECTIVE VALUE:   48762.1570681178        NO. OF FUNC. EVALS.:   6
 CUMULATIVE NO. OF FUNC. EVALS.:        6
 NPARAMETR:  1.2000E-02  4.4500E+00  2.0000E-01  2.0000E-01  5.0000E-02  5.0000E-02
 PARAMETER:  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01
 GRADIENT:  -9.5690E+02 -1.3499E+03 -3.3539E+04 -4.2687E+01 -1.2211E+03 -1.4129E+03

0ITERATION NO.:    5    OBJECTIVE VALUE:   17343.9697233043        NO. OF FUNC. EVALS.:  39
 CUMULATIVE NO. OF FUNC. EVALS.:       45
 NPARAMETR:  1.7734E+01  1.2399E+05  4.6803E-01  6.9805E-02  8.5107E+00  2.0399E+07
 PARAMETER:  7.3983E+00  1.0335E+01  3.1893E+00 -9.6581E-01  2.6685E+00  1.0013E+01
 GRADIENT:   2.4495E+02  1.9773E+02  1.3334E+02  5.3243E+01  2.2756E+01  1.5000E+02

0ITERATION NO.:   10    OBJECTIVE VALUE:   16444.5096594200        NO. OF FUNC. EVALS.:  80
 CUMULATIVE NO. OF FUNC. EVALS.:      125
 NPARAMETR:  1.6983E+00  1.2510E+08  4.6526E-01  1.2703E-01  5.1802E-01  1.6624E+02
 PARAMETER:  5.0524E+00  1.7252E+01  3.1002E+00 -3.6132E-01  1.2690E+00  4.1546E+00
 GRADIENT:   6.8856E+01  8.0553E+00  1.4356E+02  9.1709E+01 -3.2784E+01 -1.1042E+02

0ITERATION NO.:   15    OBJECTIVE VALUE:   16217.0023434776        NO. OF FUNC. EVALS.:  86
 CUMULATIVE NO. OF FUNC. EVALS.:      211
 NPARAMETR:  1.3096E+00  3.8601E+10  4.1482E-01  2.0000E-03  7.6300E-01  8.9344E+02
 PARAMETER:  4.7900E+00  2.2961E+01  2.0891E+00 -4.5451E+00  1.4626E+00  4.9954E+00
 GRADIENT:  -2.6095E+03 -2.4971E+03  2.5274E+05  0.0000E+00  0.0000E+00  0.0000E+00

 #TERM:
0MINIMIZATION TERMINATED
 DUE TO PROXIMITY OF LAST ITERATION EST. TO A VALUE
 AT WHICH THE OBJ. FUNC. IS INFINITE (ERROR=136)
0AT THE LAST COMPUTED INFINITE VALUE OF THE OBJ. FUNCT.:
 ERROR IN NCONTR WITH INDIVIDUAL      14   ID= 1.40000000000000E+01
 NUMERICAL HESSIAN OF OBJ. FUNC. FOR COMPUTING CONDITIONAL ESTIMATE
 IS NON POSITIVE DEFINITE
 THETA=
  1.31E+00   3.77E+10   4.15E-01   2.00E-03

 NO. OF FUNCTION EVALUATIONS USED:      211
 NO. OF SIG. DIGITS UNREPORTABLE
0PARAMETER ESTIMATE IS NEAR ITS BOUNDARY

 ETABAR IS THE ARITHMETIC MEAN OF THE ETA-ESTIMATES,
 AND THE P-VALUE IS GIVEN FOR THE NULL HYPOTHESIS THAT THE TRUE MEAN IS 0.

 ETABAR:        -1.2450E-02 -2.2723E+01
 SE:             8.6945E-02  5.7247E-02
 N:                      75          75

 P VAL.:         8.8614E-01  0.0000E+00

 ETASHRINKSD(%)  1.3787E+01  2.3961E+01
 ETASHRINKVR(%)  2.5673E+01  4.2180E+01
 EBVSHRINKSD(%)  3.1714E-01  3.6188E-04
 EBVSHRINKVR(%)  6.3327E-01  7.2376E-04
 RELATIVEINF(%)  9.9367E+01  9.9999E+01
 EPSSHRINKSD(%)  2.8539E+01
 EPSSHRINKVR(%)  4.8934E+01

  
 TOTAL DATA POINTS NORMALLY DISTRIBUTED (N):         2801
 N*LOG(2PI) CONSTANT TO OBJECTIVE FUNCTION:    5147.8936630125763     
 OBJECTIVE FUNCTION VALUE WITHOUT CONSTANT:    16217.002343477554     
 OBJECTIVE FUNCTION VALUE WITH CONSTANT:       21364.896006490129     
 REPORTED OBJECTIVE FUNCTION DOES NOT CONTAIN CONSTANT
  
 TOTAL EFFECTIVE ETAS (NIND*NETA):                           150
  
 #TERE:
 Elapsed estimation  time in seconds:  1595.79
0PROGRAM TERMINATED BY OBJ
 ERROR IN NCONTR WITH INDIVIDUAL      16   ID= 1.60000000000000E+01
 NUMERICAL HESSIAN OF OBJ. FUNC. FOR COMPUTING CONDITIONAL ESTIMATE
 IS NON POSITIVE DEFINITE
0S MATRIX ALGORITHMICALLY SINGULAR
0COVARIANCE MATRIX UNOBTAINABLE
 Elapsed covariance  time in seconds:   116.79
 Elapsed postprocess time in seconds:    10.18
1
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 #OBJT:**************                       MINIMUM VALUE OF OBJECTIVE FUNCTION                      ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 





 #OBJV:********************************************         16217.002       *********************************************
1
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 ********************                             FINAL PARAMETER ESTIMATE                           ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 


 THETA - VECTOR OF FIXED EFFECTS PARAMETERS   *********


         TH 1      TH 2      TH 3      TH 4     
 
         1.31E+00  3.77E+10  4.15E-01  2.00E-03
 


 OMEGA - COV MATRIX FOR RANDOM EFFECTS - ETAS  ********


         ETA1      ETA2     
 
 ETA1
+        7.63E-01
 
 ETA2
+        0.00E+00  8.93E+02
 


 SIGMA - COV MATRIX FOR RANDOM EFFECTS - EPSILONS  ****


         EPS1     
 
 EPS1
+        1.00E+00
 
1


 OMEGA - CORR MATRIX FOR RANDOM EFFECTS - ETAS  *******


         ETA1      ETA2     
 
 ETA1
+        8.73E-01
 
 ETA2
+        0.00E+00  2.99E+01
 


 SIGMA - CORR MATRIX FOR RANDOM EFFECTS - EPSILONS  ***


         EPS1     
 
 EPS1
+        1.00E+00
 
1
 ************************************************************************************************************************
 ********************                                                                                ********************
 ********************               FIRST ORDER CONDITIONAL ESTIMATION WITH INTERACTION              ********************
 ********************                                     S MATRIX                                   ********************
 ********************                                                                                ********************
 ************************************************************************************************************************
 

            TH 1      TH 2      TH 3      TH 4      OM11      OM12      OM22      SG11  
 
 TH 1
+        1.37E+07
 
 TH 2
+       -9.39E-05  1.17E-13
 
 TH 3
+       -2.36E+06 -2.38E-03  2.20E+10
 
 TH 4
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00
 
 OM11
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00
 
 OM12
+       ......... ......... ......... ......... ......... .........
 
 OM22
+        0.00E+00  0.00E+00  0.00E+00  0.00E+00  0.00E+00 .........  0.00E+00
 
 SG11
+       ......... ......... ......... ......... ......... ......... ......... .........
 
 Elapsed finaloutput time in seconds:     1.08
 #CPUT: Total CPU Time in Seconds,     1697.524
Stop Time:
vr 12 dec 2025 14:03:01 CET
