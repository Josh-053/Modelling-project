za 03 jan 2026 15:49:30 CET
;; 1. Based on: run01
;; 2. Description: PMX001 2CMT LINEAR M7+ (BASE MODEL)
;; Joshua I., Ali K.
;; 2025-12-09
$PROBLEM    PMX001 Two Compartment
$INPUT      DUMMY=DROP ID TIME WEEK DOSE=AMT RATE CONC=DROP ADA BW ALB
            SEX=DROP AGE CREAT COL EVID BLQ CONC_M7=DV
$DATA      ../../../../../../../../../../dataset_clean.csv IGNORE=@
$ABBREVIATED DERIV2=NO
$SUBROUTINE ADVAN13 ; general nonlinear model
            TOL=9 ; tolerance for $DES,higher TOL: more accurate,but slower computation

; TOL=7 -> DES will aim for accuracy of 1E-7 for each integration step
$MODEL      NCOMP=2 ; number of compartments
            COMP=(DOSE,DEFDOSE,DEFOBS) ; first (central) compartment
            COMP=(PERIPH) ; second (peripheral) compartment
$PK
;;; V1ALB-DEFINITION START
   V1ALB = EXP(THETA(11)*(ALB - 31.85))
;;; V1ALB-DEFINITION END


;;; V1CREAT-DEFINITION START
V1CREAT = ( 1 + THETA(10)*(CREAT - 1.03))
;;; V1CREAT-DEFINITION END


;;; V1BW-DEFINITION START
IF(BW.LE.65.93) V1BW = ( 1 + THETA(8)*(BW - 65.93))
IF(BW.GT.65.93) V1BW = ( 1 + THETA(9)*(BW - 65.93))
;;; V1BW-DEFINITION END


;;; V1ADA-DEFINITION START
IF(ADA.EQ.0) V1ADA = 1  ; Most common
IF(ADA.EQ.1) V1ADA = ( 1 + THETA(7))
;;; V1ADA-DEFINITION END

;;; V1-RELATION START
V1COV=V1ADA*V1BW*V1CREAT*V1ALB
;;; V1-RELATION END


;;; CLAGE-DEFINITION START
CLAGE = ( 1 + THETA(6)*(AGE - 33.17))
;;; CLAGE-DEFINITION END


;;; CLADA-DEFINITION START
IF(ADA.EQ.0) CLADA = 1  ; Most common
IF(ADA.EQ.1) CLADA = ( 1 + THETA(5))
;;; CLADA-DEFINITION END

;;; CL-RELATION START
CLCOV=CLADA*CLAGE
;;; CL-RELATION END


IF (EVID.EQ.1) LASTDOSE = TIME
TAD = TIME - LASTDOSE

TVCL = THETA(1)

TVCL = CLCOV*TVCL
TVV1 = THETA(2)

TVV1 = V1COV*TVV1
TVV2 = THETA(3)
 TVQ = THETA(4)
   
  CL = TVCL * EXP(ETA(1))
  V1 = TVV1 * EXP(ETA(2))
  V2 = TVV2
   Q = TVQ
 
 K10 = CL/V1
 K12 = Q/V1
 K21 = Q/V2
 
  S1 = V1/1 ; scale prediction based on DOSE (mmol) and DV (mmol/L)
  S2 = V2/1

$THETA  (0.001,1.42341,8) ; [1]   CL (L/d)
 (0.001,7.4501,10) ; [2,3] V1  (L)
 (0.01,0.185487,6) ; V2
 (0.001,1.3306,6) ; Q
 ; values are determined in 3 iterations
$THETA  (-1,4.18369,5) ; CLADA1
$THETA  (-0.050,0.0297748,0.074) ; CLAGE1
$THETA  (-1,-0.273206,5) ; V1ADA1
$THETA  (-100000,0.0126373,0.042) ; V1BW1
 (-0.055,-0.0510103,100000) ; V1BW2
$THETA  (-1.250,0.277515,1.190) ; V1CREAT1
$THETA  (-0.388950184627373,0.0145913,0.388950184627373) ; V1ALB1
$DES DADT(1) = -K10*A(1) -K12*A(1) +K21*A(2) ; ODE for central    compartment
     DADT(2) =            K12*A(1) -K21*A(2) ; ODE for peripheral compartment
     
$ERROR
IPRED = F
LLOQ = 1  ; (mg/L)

; --- Residual error SDs ---
PROP_SD = SIGMA(1)
ADD_SD  = SIGMA(2)

; --- BLQ inflation (gentle, stable) ---
IF (BLQ.EQ.1) ADD_SD = ADD_SD + LLOQ

; --- Final residual error ---
W = SQRT(ADD_SD**2+PROP_SD**2)

IF (W.LE.0.000001) W=0.000001 ; Protective code

IRES=DV-IPRED
IWRES=IRES/W
Y = IPRED * (1 + EPS(1)) + EPS(2)

$OMEGA  0.565718  ;     IIV CL
 0.370554  ;      IIV V
$SIGMA  0.278882  ; EPS(1), proportional
 5E-13  FIX  ;     EPS(2)  ; additive, required by M7+ censoring method
    ; residual variability
$ESTIMATION METHOD=1 INTERACTION ; FOCE-I
            SIG=3 SIGL=4 PRINT=5 MAXEVALS=9999 CTYPE=4


NM-TRAN MESSAGES
  
 WARNINGS AND ERRORS (IF ANY) FOR PROBLEM    1
             
 (WARNING  2) NM-TRAN INFERS THAT THE DATA ARE POPULATION.
             
 (WARNING  79) SIGMA IS USED ON THE RIGHT. WITH A SUBSEQUENT RUN, IF AN
 INITIAL ESTIMATE OF A DIAGONAL BLOCK OF SIGMA IS TO BE COMPUTED BY
 NONMEM, THAT BLOCK WILL BE SET TO AN IDENTITY MATRIX DURING THAT
 COMPUTATION. THIS COULD LEAD TO AN ARITHMETIC EXCEPTION.*

 * THE MAXIMUM NUMBER OF WARNINGS OF ONE OR MORE TYPES WAS REACHED.
 IT IS POSSIBLE THAT SOME WARNING MESSAGES WERE SUPPRESSED.

License Registered to: Erwin DREESEN KU Leuven
Expiration Date:    25 JAN 2026
Current Date:        3 JAN 2026
  **** WARNING!!! Days until program expires :  22 ****
  **** CONTACT idssoftware@iconplc.com FOR RENEWAL ****
1NONLINEAR MIXED EFFECTS MODEL PROGRAM (NONMEM) VERSION 7.6.0 (nm760)
 ORIGINALLY DEVELOPED BY STUART BEAL, LEWIS SHEINER, AND ALISON BOECKMANN
 CURRENT DEVELOPERS ARE ROBERT BAUER, ICON DEVELOPMENT SOLUTIONS,
 AND ALISON BOECKMANN. IMPLEMENTATION, EFFICIENCY, AND STANDARDIZATION
 PERFORMED BY NOUS INFOSYSTEMS.

 PROBLEM NO.:         1
 PMX001 Two Compartment
0DATA CHECKOUT RUN:              NO
 DATA SET LOCATED ON UNIT NO.:    2
 THIS UNIT TO BE REWOUND:        NO
 CREATE/ADD TO FDATA.csv:        YES
 NO. OF DATA RECS IN DATA SET:    11475
 NO. OF DATA ITEMS IN DATA SET:  15
 ID DATA ITEM IS DATA ITEM NO.:   1
 DEP VARIABLE IS DATA ITEM NO.:  14
 MDV DATA ITEM IS DATA ITEM NO.: 15
0INDICES PASSED TO SUBROUTINE PRED:
  12   2   4   5   0   0   0   0   0   0   0
0LABELS FOR DATA ITEMS:
 ID TIME WEEK DOSE RATE ADA BW ALB AGE CREAT COL EVID BLQ CONC_M7 MDV
0FORMAT FOR DATA:
 (E2.0,E18.0,E2.0,2E16.0,E1.0,E16.0/2E16.0,E17.0,3E1.0,E16.0,1F2.0)

 TOT. NO. OF OBS RECS:     2801
 TOT. NO. OF INDIVIDUALS:       75
0LENGTH OF THETA:  11
0DEFAULT THETA BOUNDARY TEST OMITTED:    NO
0OMEGA HAS SIMPLE DIAGONAL FORM WITH DIMENSION:   2
0DEFAULT OMEGA BOUNDARY TEST OMITTED:    NO
0SIGMA HAS BLOCK FORM:
  1
  0  2
0DEFAULT SIGMA BOUNDARY TEST OMITTED:    NO
0INITIAL ESTIMATE OF THETA:
 LOWER BOUND    INITIAL EST    UPPER BOUND
  0.1000E-02     0.1423E+01     0.8000E+01
  0.1000E-02     0.7450E+01     0.1000E+02
  0.1000E-01     0.1855E+00     0.6000E+01
  0.1000E-02     0.1331E+01     0.6000E+01
 -0.1000E+01     0.4184E+01     0.5000E+01
 -0.5000E-01     0.2977E-01     0.7400E-01
 -0.1000E+01    -0.2732E+00     0.5000E+01
 -0.1000E+06     0.1264E-01     0.4200E-01
 -0.5500E-01    -0.5101E-01     0.1000E+06
 -0.1250E+01     0.2775E+00     0.1190E+01
 -0.3890E+00     0.1459E-01     0.3890E+00
0INITIAL ESTIMATE OF OMEGA:
 0.5657E+00
 0.0000E+00   0.3706E+00
0INITIAL ESTIMATE OF SIGMA:
 BLOCK SET NO.   BLOCK                                                                    FIXED
        1                                                                                   NO
                  0.2789E+00
        2                                                                                  YES
                  0.5000E-12
1DOUBLE PRECISION PREDPP VERSION 7.6.0 (nm760)

 GENERAL NONLINEAR KINETICS MODEL WITH STIFF/NONSTIFF EQUATIONS (LSODA, ADVAN13)
0MODEL SUBROUTINE USER-SUPPLIED - ID NO. 9999
0MAXIMUM NO. OF BASIC PK PARAMETERS:   3
0COMPARTMENT ATTRIBUTES
 COMPT. NO.   FUNCTION   INITIAL    ON/OFF      DOSE      DEFAULT    DEFAULT
                         STATUS     ALLOWED    ALLOWED    FOR DOSE   FOR OBS.
    1         DOSE         ON         YES        YES        YES        YES
    2         PERIPH       ON         YES        YES        NO         NO
    3         OUTPUT       OFF        YES        NO         NO         NO
 INITIAL (BASE) TOLERANCE SETTINGS:
 NRD (RELATIVE) VALUE(S) OF TOLERANCE:   9
 ANRD (ABSOLUTE) VALUE(S) OF TOLERANCE:  12
1
 ADDITIONAL PK PARAMETERS - ASSIGNMENT OF ROWS IN GG
 COMPT. NO.                             INDICES
              SCALE      BIOAVAIL.   ZERO-ORDER  ZERO-ORDER  ABSORB
                         FRACTION    RATE        DURATION    LAG
    1            4           *           *           *           *
    2            5           *           *           *           *
    3            *           -           -           -           -
             - PARAMETER IS NOT ALLOWED FOR THIS MODEL
             * PARAMETER IS NOT SUPPLIED BY PK SUBROUTINE;
               WILL DEFAULT TO ONE IF APPLICABLE
0DATA ITEM INDICES USED BY PRED ARE:
   EVENT ID DATA ITEM IS DATA ITEM NO.:     12
   TIME DATA ITEM IS DATA ITEM NO.:          2
   DOSE AMOUNT DATA ITEM IS DATA ITEM NO.:   4
   DOSE RATE DATA ITEM IS DATA ITEM NO.:     5

0PK SUBROUTINE CALLED WITH EVERY EVENT RECORD.
 PK SUBROUTINE NOT CALLED AT NONEVENT (ADDITIONAL OR LAGGED) DOSE TIMES.
0ERROR SUBROUTINE CALLED WITH EVERY EVENT RECORD.
0DES SUBROUTINE USES COMPACT STORAGE MODE.
1


 #TBLN:      1
 #METH: First Order Conditional Estimation with Interaction

 ESTIMATION STEP OMITTED:                 NO
 SHRINK INFO WITH EVALUATION (EVALSHRINK) NO
 ANALYSIS TYPE:                           POPULATION
 NUMBER OF SADDLE POINT RESET ITERATIONS:      0
 GRADIENT METHOD USED:               NOSLOW
 CONDITIONAL ESTIMATES USED:              YES
 CENTERED ETA:                            NO
 EPS-ETA INTERACTION:                     YES
 LAPLACIAN OBJ. FUNC.:                    NO
 NO. OF FUNCT. EVALS. ALLOWED:            9999
 NO. OF SIG. FIGURES REQUIRED:            3
 INTERMEDIATE PRINTOUT:                   YES
 ESTIMATE OUTPUT TO MSF:                  NO
 IND. OBJ. FUNC. VALUES SORTED:           NO
 NUMERICAL DERIVATIVE
       FILE REQUEST (NUMDER):               NONE
 MAP (ETAHAT) ESTIMATION METHOD (OPTMAP):   0
 ETA HESSIAN EVALUATION METHOD (ETADER):    0
 INITIAL ETA FOR MAP ESTIMATION (MCETA):    0
 SIGDIGITS FOR MAP ESTIMATION (SIGLO):      4
 GRADIENT SIGDIGITS OF
       FIXED EFFECTS PARAMETERS (SIGL):     4
 NOPRIOR SETTING (NOPRIOR):                 0
 NOCOV SETTING (NOCOV):                     OFF
 DERCONT SETTING (DERCONT):                 OFF
 FINAL ETA RE-EVALUATION (FNLETA):          1
 EXCLUDE NON-INFLUENTIAL (NON-INFL.) ETAS
       IN SHRINKAGE (ETASTYPE):             NO
 NON-INFL. ETA CORRECTION (NONINFETA):      0
 RAW OUTPUT FILE (FILE): psn.ext
 EXCLUDE TITLE (NOTITLE):                   NO
 EXCLUDE COLUMN LABELS (NOLABEL):           NO
 FORMAT FOR ADDITIONAL FILES (FORMAT):      S1PE12.5
 PARAMETER ORDER FOR OUTPUTS (ORDER):       TSOL
 KNUTHSUMOFF:                               0
 INCLUDE LNTWOPI:                           NO
 INCLUDE CONSTANT TERM TO PRIOR (PRIORC):   NO
 INCLUDE CONSTANT TERM TO OMEGA (ETA) (OLNTWOPI):NO
 ADDITIONAL CONVERGENCE TEST (CTYPE=4)?:    YES
 EM OR BAYESIAN METHOD USED:                 NONE

 TOLERANCES FOR ESTIMATION/EVALUATION STEP:
 NRD (RELATIVE) VALUE(S) OF TOLERANCE:   9
 ANRD (ABSOLUTE) VALUE(S) OF TOLERANCE:  12
 TOLERANCES FOR COVARIANCE STEP:
 NRD (RELATIVE) VALUE(S) OF TOLERANCE:   9
 ANRD (ABSOLUTE) VALUE(S) OF TOLERANCE:  12

 THE FOLLOWING LABELS ARE EQUIVALENT
 PRED=PREDI
 RES=RESI
 WRES=WRESI
 IWRS=IWRESI
 IPRD=IPREDI
 IRS=IRESI

 MONITORING OF SEARCH:


0ITERATION NO.:    0    OBJECTIVE VALUE:   10911.8078604651        NO. OF FUNC. EVALS.:  14
 CUMULATIVE NO. OF FUNC. EVALS.:       14
 NPARAMETR:  1.4234E+00  7.4501E+00  1.8549E-01  1.3306E+00  4.1837E+00  2.9775E-02 -2.7321E-01  1.2637E-02 -5.1010E-02  2.7752E-01
             1.4591E-02  5.6572E-01  3.7055E-01  2.7888E-01
 PARAMETER:  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01
             1.0000E-01  1.0000E-01  1.0000E-01  1.0000E-01
 GRADIENT:  -6.9763E-01  1.6615E+01 -4.8229E+00  7.7793E-01 -1.3200E+00  6.1817E-01  6.3233E+00 -5.9174E+00  1.2082E+00  1.3363E+00
             2.3627E+02  1.8083E+00  4.4382E+00 -4.4570E+01

0ITERATION NO.:    5    OBJECTIVE VALUE:   10820.3434351582        NO. OF FUNC. EVALS.:  76
 CUMULATIVE NO. OF FUNC. EVALS.:       90
 NPARAMETR:  1.4123E+00  6.0736E+00  2.0165E-01  1.3020E+00  4.1918E+00  2.9120E-02 -2.7762E-01  2.0515E-02 -5.1606E-02  2.1273E-01
            -1.3652E-01  5.6128E-01  5.5306E-01  2.7373E-01
 PARAMETER:  9.0488E-02 -5.3598E-01  1.9092E-01  7.2185E-02  1.1151E-01  7.7047E-02  9.3076E-02  4.1238E-01 -6.1742E-02 -1.1929E-02
            -7.0820E-01  9.6060E-02  3.0024E-01  9.0672E-02
 GRADIENT:   1.8235E-01  4.1854E+00 -2.9825E+00 -1.5006E-01 -5.7903E-01  8.2735E-01  1.2135E+00  2.4575E+00  4.1127E+00 -4.8149E-01
            -2.3947E+00 -9.7674E-02  1.5453E+01 -9.1577E+01

0ITERATION NO.:   10    OBJECTIVE VALUE:   10818.3434684454        NO. OF FUNC. EVALS.:  77
 CUMULATIVE NO. OF FUNC. EVALS.:      167
 NPARAMETR:  1.4387E+00  5.7699E+00  2.5364E-01  1.6171E+00  4.2511E+00  2.5871E-02 -2.6487E-01  1.5926E-02 -5.3110E-02  1.5280E-01
            -1.3775E-01  5.7004E-01  5.6206E-01  2.7542E-01
 PARAMETER:  1.1299E-01 -6.6178E-01  4.3992E-01  3.5846E-01  1.9904E-01 -3.4769E-02  1.1299E-01  2.1878E-01 -6.4689E-01 -1.1328E-01
            -7.1546E-01  1.0380E-01  3.0830E-01  9.3749E-02
 GRADIENT:   6.0107E+00  1.3005E+00 -1.3850E+00 -7.5440E-01 -6.1725E-01 -3.8682E-01  3.1948E+00 -2.1345E-01  2.1433E+00 -7.4309E+00
            -1.3841E+00  2.2706E+00  1.1550E+01 -6.8294E+01
0PRED EXIT CODE = 1
0INDIVIDUAL NO.      12   ID= 1.20000000000000E+01   (WITHIN-INDIVIDUAL) DATA REC NO. 146
 THETA=
  1.44E+00   5.81E+00   2.71E-01   3.24E+00   4.41E+00   3.23E-02  -2.53E-01   1.77E-02  -5.46E-02   2.90E-01
 -1.31E-01
 OCCURS DURING SEARCH FOR ETA AT INITIAL VALUE, ETA=0
 PK PARAMETER FOR OBSERVATION COMPARTMENT'S SCALE IS NON-POSITIVE                                                                    
0PROGRAM TERMINATED BY OBJ
 MESSAGE ISSUED FROM ESTIMATION STEP

 #TERM:
  
 TOTAL DATA POINTS NORMALLY DISTRIBUTED (N):          415
 N*LOG(2PI) CONSTANT TO OBJECTIVE FUNCTION:    762.71898255987833     
 OBJECTIVE FUNCTION VALUE WITHOUT CONSTANT:    10815.709960895283     
 OBJECTIVE FUNCTION VALUE WITH CONSTANT:       11578.428943455161     
 REPORTED OBJECTIVE FUNCTION DOES NOT CONTAIN CONSTANT
  
 TOTAL EFFECTIVE ETAS (NIND*NETA):                            22
  
 #TERE:
 Elapsed estimation  time in seconds:   215.99
1THERE ARE ERROR MESSAGES IN FILE PRDERR                                                                  
 #CPUT: Total CPU Time in Seconds,      215.820
Stop Time:
za 03 jan 2026 15:53:16 CET
